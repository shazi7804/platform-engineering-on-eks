"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7616],{87616:(xt,re,n)=>{n.r(re),n.d(re,{LegacyRouter:()=>bt});var e=n(85668),M=n(33648),h=n(8024),R=n(91812),I=n(29292),ye=n(7400),L=n(38348),k=n(17376),Me=n(3052),N=n(40476),x=n(94700),J=n(87648),Ce=n(76048),Z=n(42704),Te=n(96196),q=n(43152),Q=n(8640),Ae=n(84480),Re=n(8084),j=n(67256),Ie=n(22776),$=n(1275),Le=n(36456),Be=n(57384),Ue=n(42440),Ke=n(84312),le=n(77600),oe=n(53232),se=n(54828),ie=n(87132),X=n(6280),ce=n(1700),me=n(91548),Ee=n(38656),Se=n(85120),y=n(64300),We=n(19664),be=n(19163),ee=n(62579),te=n(46444),xe=n(56104),Fe=n(76488),Ne=n(88312),we=n(35936),ke=n(89456),je=n(40336),Ft=n(37836),$e=n(55632),de=n.n($e),ue=n(35848),V=n(66440),_e=n(83024),ze=n(2152),Xe=n(83260),Ve=n(2704),Ye=n.n(Ve),pe=n(44168),fe=n(52316),B=n(87696),He=n(19540),ae=n(58368),ge=n(87987),Je=n(48152),Qe=n(99812),Ge=n(59264),Ze=n(98880),Nt=n.n(Ze),qe=n(55224),wt=n.n(qe),et=n(28364),kt=n.n(et),tt=n(71252),jt=n.n(tt),$t=n(40459),at=n(26044),zt=n.n(at);const nt=(0,N.c)(t=>({cardHeader:{position:"relative"},title:{backgroundImage:({backgroundImage:a})=>a,color:({fontColor:a})=>a},box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},label:{color:t.palette.text.secondary,textTransform:"uppercase",fontSize:"0.65rem",fontWeight:"bold",letterSpacing:.5,lineHeight:1,paddingBottom:"0.2rem"},linksLabel:{padding:"0 16px"},description:{"& p":{margin:"0px"}},leftButton:{marginRight:"auto"},starButton:{position:"absolute",top:t.spacing(.5),right:t.spacing(.5),padding:"0.25rem",color:({fontColor:a})=>a}})),ve=({icon:t})=>e.createElement(t,null),rt=(0,N.c)(t=>({deprecationIcon:{position:"absolute",top:t.spacing(.5),right:t.spacing(3.5),padding:"0.25rem"},link:{color:t.palette.warning.light}})),lt=t=>{var a,l,s,r,i,c;return{key:t.metadata.uid,name:t.metadata.name,title:`${(a=t.metadata.title||t.metadata.name)!=null?a:""}`,type:(l=t.spec.type)!=null?l:"",description:(s=t.metadata.description)!=null?s:"-",tags:(i=(r=t.metadata)==null?void 0:r.tags)!=null?i:[],links:(c=t.metadata.links)!=null?c:[]}},ot=()=>{const t=rt(),a=e.createElement(x.c,{style:{padding:10,maxWidth:300}},"This template uses a syntax that has been deprecated, and should be migrated to a newer syntax. Click for more info.");return e.createElement("div",{className:t.deprecationIcon},e.createElement(J.cp,{title:a},e.createElement(h.Mj,{to:"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3",className:t.link},e.createElement(Se.c,null))))},st=({template:t,deprecated:a})=>{var l,s,r;const i=(0,R.IT)(),c=(0,Ce.c)(),m=(0,R.M7)(y.o),o=lt(t),p=(0,ye.g)(t,k.ag),E=c.getPageTheme({themeId:o.type})?o.type:"other",f=c.getPageTheme({themeId:E}),u=nt({fontColor:f.fontColor,backgroundImage:f.backgroundImage}),{name:O,namespace:_}=(0,k.WK)((0,k.Qj)(t)),v=m({templateName:O,namespace:_}),P=(0,R.M7)(y.v),d=!!((l=t.metadata.annotations)==null?void 0:l["backstage.io/techdocs-ref"])&&!!P&&P({namespace:t.metadata.namespace||k.IV,kind:t.kind,name:t.metadata.name}),g=T=>{var F;return T&&(F=i.getSystemIcon(T))!=null?F:Ee.c},S=(0,I.u)(me.u1),U=(0,L.MF)(t,S);return e.createElement(Z.c,null,e.createElement(Te.c,{className:u.cardHeader},e.createElement(L.YR,{className:u.starButton,entity:t}),a&&e.createElement(ot,null),e.createElement(h.mc,{title:o.title,subtitle:o.type,classes:{root:u.title}})),e.createElement(q.c,{style:{display:"flex",flexDirection:"column",gap:"16px"}},e.createElement(Q.c,{className:u.box},e.createElement(x.c,{variant:"body2",className:u.label},"Description"),e.createElement(h.Ko,{className:u.description,content:o.description})),e.createElement(Q.c,{className:u.box},e.createElement(x.c,{variant:"body2",className:u.label},"Owner"),e.createElement(L.aK,{entityRefs:p,defaultKind:"Group",hideIcons:!0})),e.createElement(Q.c,null,e.createElement(x.c,{style:{marginBottom:"4px"},variant:"body2",className:u.label},"Tags"),(s=o.tags)==null?void 0:s.map(T=>e.createElement(Ae.c,{size:"small",label:T,key:T})))),e.createElement(x.c,{variant:"body2",className:[u.label,u.linksLabel].join(" ")},"Links"),e.createElement(Re.c,null,e.createElement("div",{className:u.leftButton},U&&e.createElement(J.cp,{title:U.integrationType||U.locationTargetUrl},e.createElement(j.c,{className:u.leftButton,href:U.locationTargetUrl},e.createElement(me.mo,{type:U.integrationType}))),d&&e.createElement(J.cp,{title:"View TechDocs"},e.createElement(j.c,{className:u.leftButton,href:d},e.createElement(ve,{icon:g("docs")}))),(r=o.links)==null?void 0:r.map((T,F)=>e.createElement(J.cp,{key:`${T.url}_${F}`,title:T.title||T.url},e.createElement(j.c,{size:"medium",href:T.url},e.createElement(ve,{icon:g(T.icon)}))))),e.createElement(h.EZ,{color:"primary",to:v,"aria-label":`Choose ${o.title}`},"Choose")))},he=({TemplateCardComponent:t,group:a,templateFilter:l})=>{const{loading:s,error:r,entities:i}=(0,L.HI)(),c=t||st,m=i.filter(Me.u),o=(a?m.filter(a.filter):m).filter(E=>l?l(E):!0),p=(()=>a&&a.title?typeof a.title=="string"?e.createElement(h.YC,{title:a.title}):a.title:e.createElement(h.YC,{title:"Other Templates"}))();return a&&o.length===0?null:e.createElement(e.Fragment,null,s&&e.createElement(h.b$,null),r&&e.createElement(h.mC,{title:"Oops! Something went wrong loading the templates"},r.message),!r&&!s&&!i.length&&e.createElement(x.c,{variant:"body2"},"No templates found that match your filter. Learn more about"," ",e.createElement(h.Mj,{to:"https://backstage.io/docs/features/software-templates/adding-templates"},"adding templates"),"."),e.createElement(h.kP,null,p,e.createElement(h.cf,null,o&&(o==null?void 0:o.length)>0&&o.map(E=>e.createElement(c,{key:(0,k.Qj)(E),template:E,deprecated:E.apiVersion==="backstage.io/v1beta2"})))))},it=(0,N.c)(t=>({button:{color:t.page.fontColor}}));function ct(t){const a=it(),[l,s]=(0,e.useState)(),r=(0,R.M7)(y.p),i=(0,R.M7)(y.q),c=(0,R.M7)(y.t),m=(0,M.i6)(),o=t.editor!==!1,p=t.actions!==!1,E=t.tasks!==!1;if(!o&&!p)return null;const f=O=>{s(O.currentTarget)},u=()=>{s(void 0)};return e.createElement(e.Fragment,null,e.createElement(j.c,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!l,"aria-haspopup":"true",role:"button",onClick:f,"data-testid":"menu-button",color:"inherit",className:a.button},e.createElement(je.c,null)),e.createElement(Fe.cp,{"aria-labelledby":"long-menu",open:Boolean(l),onClose:u,anchorEl:l,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e.createElement(xe.c,null,o&&e.createElement(X.c,{onClick:()=>m(r())},e.createElement(ee.c,null,e.createElement(we.c,{fontSize:"small"})),e.createElement(te.c,{primary:"Template Editor"})),p&&e.createElement(X.c,{onClick:()=>m(i())},e.createElement(ee.c,null,e.createElement(Ne.c,{fontSize:"small"})),e.createElement(te.c,{primary:"Installed Actions"})),E&&e.createElement(X.c,{onClick:()=>m(c())},e.createElement(ee.c,null,e.createElement(ke.c,{fontSize:"small"})),e.createElement(te.c,{primary:"Task List"})))))}const mt=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>{const i=(0,R.M7)(y.u),c={title:a?"Other Templates":"Templates",filter:o=>!(a!=null?a:[]).map(E=>E.filter(o)).some(E=>E===!0)},{allowed:m}=(0,be.wQ)({permission:We.ai});return e.createElement(h.K2,{themeId:"home"},e.createElement(h.ek,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...r},e.createElement(ct,{...s})),e.createElement(h.kP,null,e.createElement(h.YC,{title:"Available Templates"},m&&e.createElement(h.Qz,{title:"Register Existing Component",to:i&&i()}),e.createElement(h.iY,null,"Create new software components using standard templates. Different templates create different kinds of components (services, websites, documentation, ...).")),e.createElement(L.UJ,null,e.createElement(L.UJ.Filters,null,e.createElement(L.Ib,null),e.createElement(L.tR,{initialFilter:"template",hidden:!0}),e.createElement(L.Mb,{initialFilter:"all",availableFilters:["all","starred"]}),e.createElement(y.T,null),e.createElement(L.ER,null)),e.createElement(L.UJ.Content,null,a&&a.map((o,p)=>e.createElement(he,{key:p,TemplateCardComponent:t,group:o,templateFilter:l})),e.createElement(he,{key:"other",TemplateCardComponent:t,templateFilter:l,group:c})))))},Et=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>e.createElement(L.a0,null,e.createElement(mt,{TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r}));function b(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function w(t,a){if(!b(t))return;const{properties:l,items:s,anyOf:r,oneOf:i,allOf:c,dependencies:m}=t;for(const o in t)t.hasOwnProperty(o)&&o.startsWith("ui:")&&(a[o]=t[o],delete t[o]);if(b(l))for(const o in l){if(!l.hasOwnProperty(o))continue;const p=l[o];if(!b(p))continue;const E={};a[o]=a[o]||E,w(p,E)}if(b(s)){const o={};a.items=o,w(s,o)}if(Array.isArray(r))for(const o of r)b(o)&&w(o,a);if(Array.isArray(i))for(const o of i)b(o)&&w(o,a);if(Array.isArray(c))for(const o of c)b(o)&&w(o,a);if(b(m))for(const o of Object.keys(m)){const p=m[o];b(p)&&w(p,a)}}function dt(t,a=[]){var l;const s=t["ui:ObjectFieldTemplate"];t.type=t.type||"object";const r=JSON.parse(JSON.stringify(t));delete r.title;const i={};if(w(r,i),s){const c=(l=a.find(m=>m.name===s))==null?void 0:l.component;c&&(i["ui:ObjectFieldTemplate"]=c)}return{schema:r,uiSchema:i}}var ut=Object.freeze({__proto__:null,DescriptionField:({description:t})=>t&&e.createElement(h.Ko,{content:t,linkTarget:"_blank"})});function _t(t,a){const l={},s=new Set(a.map(r=>r.name).concat(Object.getOwnPropertyNames(t)));for(const r of s){const i=a.find(m=>m.name===r);if(!i){l[r]=t[r];continue}if(i["ui:widget"]==="password"){l[r]="******";continue}if(!i["ui:backstage"]||!i["ui:backstage"].review){l[r]=t[r];continue}const c=i["ui:backstage"].review;if(c.mask){l[r]=c.mask;continue}c.show&&(l[r]=t[r])}return l}function pt(t){const a=[];return t.forEach(l=>{const s=l.schema.properties;for(const r in s)if(s.hasOwnProperty(r)){const i=s[r];i.name=r,a.push(i)}}),a}const ft=t=>{const{disableButtons:a,formData:l,handleBack:s,handleCreate:r,handleReset:i,steps:c}=t;return e.createElement(h.kP,null,e.createElement(Ie.c,{square:!0,elevation:0},e.createElement(x.c,{variant:"h6"},"Review and create"),e.createElement(h.OA,{dense:!0,metadata:_t(l,pt(c.map(({mergedSchema:m})=>({schema:m}))))}),e.createElement(Q.c,{mb:4}),e.createElement($.c,{onClick:s,disabled:a},"Back"),e.createElement($.c,{onClick:i,disabled:a},"Reset"),e.createElement($.c,{variant:"contained",color:"primary",onClick:r,disabled:a},"Create")))},gt=(0,ze.QX)(Xe.So);function vt(t){return t.map(({schema:a})=>({mergedSchema:a,...(0,fe.qK)(a)}))}const Oe=t=>{const{formData:a,onChange:l,onReset:s,onFinish:r,fields:i,widgets:c,layouts:m,ReviewStepComponent:o}=t,{templateName:p}=(0,R.oD)(y.o),E=(0,R.S2)(),[f,u]=(0,e.useState)(0),[O,_]=(0,e.useState)(!1),v=(0,I.u)(I.r),P=(0,I.u)(I.f),C="backstage:featureFlag",d=D=>{var W;const K=Ye()(D),G=[];return K.schema.properties&&(K.schema.properties=Object.fromEntries(Object.entries(K.schema.properties).filter(([H,Pe])=>Pe[C]?P.isActive(Pe[C])?!0:(G.push(H),!1):!0)),K.schema.required=Array.isArray(K.schema.required)?(W=K.schema.required)==null?void 0:W.filter(H=>!G.includes(H)):K.schema.required),K},g=t.steps.filter(D=>{const W=D.schema[C];return typeof W!="string"||P.isActive(W)}).map(d),S=()=>{u(0),s()},U=()=>{const D=Math.min(f+1,g.length);u(D),E.captureEvent("click",`Next Step (${D})`)},T=()=>u(Math.max(f-1,0)),F=async()=>{if(r){_(!0);try{await r(),E.captureEvent("create",a.name||`new ${p}`)}catch(D){v.post(D)}finally{_(!1)}}},A=o!=null?o:ft;return e.createElement(e.Fragment,null,e.createElement(Le.c,{activeStep:f,orientation:"vertical"},g.map(({title:D,schema:W,...K},G)=>e.createElement(Be.c,{key:D},e.createElement(Ue.c,{"aria-label":`Step ${G+1} ${D}`,"aria-disabled":"false",tabIndex:0},e.createElement(x.c,{variant:"h6",component:"h2"},D)),e.createElement(Ke.c,{key:D},e.createElement(gt,{validator:pe.cp,showErrorList:!1,fields:{...ut,...i},widgets:c,noHtml5Validate:!0,formData:a,formContext:{formData:a},onChange:l,onSubmit:H=>{H.errors.length===0&&U()},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},...K,...dt(W,m)},e.createElement($.c,{disabled:f===0,onClick:T},"Back"),e.createElement($.c,{variant:"contained",color:"primary",type:"submit"},"Next step")))))),f===g.length&&e.createElement(A,{disableButtons:O,handleBack:T,handleCreate:F,handleReset:S,formData:a,steps:vt(g)}))};function z(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function ht(t){return typeof t=="object"&&t!==null&&Array.isArray(t)}const De=(t,a,l)=>{function s(r,i,c){var m;const o=r.properties,p=r.type==="object"&&o===void 0;if(!(!z(o)&&!p)){if(o)for(const[E,f]of Object.entries(i)){const u=c[E],O=v=>{if(v&&z(v)){const P=v["ui:field"];P&&typeof a[P]=="function"&&a[P](f,u,l)}},_=o[E];if(z(f)&&z(_))s(_,f,u);else if(ht(f)){if(z(_)){const{items:v}=_;if(z(v))if(v.type==="object"){const P=(m=v==null?void 0:v.properties)!=null?m:[];for(const[,C]of Object.entries(P))O(C)}else O(v)}}else O(_)}else if(p){const E=r["ui:field"];E&&typeof a[E]=="function"&&a[E](i,c,l)}}}return(r,i)=>(s(t,r,i),i)},Ot=t=>{const a=(0,I.u)(V.s),{value:l,loading:s,error:r}=(0,ue.default)(()=>a.getTemplateParameterSchema(t),[a,t]);return{schema:l,loading:s,error:r}},Dt=({ReviewStepComponent:t,customFieldExtensions:a=[],layouts:l=[],headerOptions:s})=>{const r=(0,I.b)(),i=(0,V.u)(),c=(0,I.u)(I.r),m=(0,I.u)(V.s),{templateName:o,namespace:p}=(0,R.oD)(y.o),E=(0,k.Qj)({name:o,kind:"template",namespace:p}),f=(0,M.i6)(),u=(0,R.M7)(y.w),O=(0,R.M7)(y.r),{schema:_,loading:v,error:P}=Ot(E),[C,d]=(0,e.useState)(()=>{var A;const D=de().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(D.formData)}catch{return(A=D.formData)!=null?A:{}}}),g=()=>d({}),S=(0,e.useCallback)(A=>d(A.formData),[d]),U=async()=>{var A;const{taskId:D}=await m.scaffold({templateRef:E,values:C,secrets:i==null?void 0:i.secrets}),W=de().stringify({formData:C},{addQueryPrefix:!0}),K=`${window.location.pathname}${W}`;(A=window.history)==null||A.replaceState(null,document.title,K),f(u({taskId:D}))};if(P)return c.post(new Error(`Failed to load template, ${P}`)),e.createElement(M.YX,{to:O()});if(!v&&!_)return c.post(new Error("Template was not found.")),e.createElement(M.YX,{to:O()});const T=Object.fromEntries(a.map(({name:A,component:D})=>[A,D])),F=Object.fromEntries(a.map(({name:A,validation:D})=>[A,D]));return e.createElement(R.cz,{attributes:{entityRef:E}},e.createElement(h.K2,{themeId:"home"},e.createElement(h.ek,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...s}),e.createElement(h.kP,null,v&&e.createElement(le.c,{"data-testid":"loading-progress"}),_&&e.createElement(h.I3,{title:_.title,noPadding:!0,titleTypographyProps:{component:"h2"}},e.createElement(Oe,{ReviewStepComponent:t,formData:C,fields:T,onChange:S,onReset:g,onFinish:U,layouts:l,steps:_.steps.map(A=>({...A,validate:De(A.schema,F,{apiHolder:r})}))})))))};var Pt=Object.defineProperty,yt=(t,a,l)=>a in t?Pt(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,Mt=(t,a,l)=>(yt(t,typeof a!="symbol"?a+"":a,l),l);const Ct=(0,N.c)({containerWrapper:{position:"relative",width:"100%",height:"100%"},container:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"auto"}});class Tt extends e.Component{constructor(){super(...arguments),Mt(this,"state",{shouldRender:!0})}componentDidUpdate(a){a.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(a){this.props.setErrorText(a.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function ne(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Y(t){const{content:a,contentIsSpec:l,data:s,onUpdate:r,onDryRun:i,setErrorText:c,fieldExtensions:m=[],layouts:o=[]}=t,p=Ct(),E=(0,I.b)(),[f,u]=(0,e.useState)(),O=(0,e.useMemo)(()=>Object.fromEntries(m.map(({name:_,component:v})=>[_,v])),[m]);return(0,He.c)(()=>{try{if(!a){u(void 0);return}const _=ae.cp.parseAllDocuments(a).filter(d=>d).map(d=>d.toJSON())[0];if(!ne(_)){u(void 0);return}let v=_;if(!l){if(!(String(_.kind).toLocaleLowerCase("en-US")==="template")){u(void 0);return}v=ne(_.spec)?_.spec:{}}const{parameters:P}=v;if(!Array.isArray(P)){c("Template parameters must be an array"),u(void 0);return}const C=Object.fromEntries(m.map(({name:d,validation:g})=>[d,g]));c(),u(P.flatMap(d=>ne(d)?[{title:String(d.title),schema:d,validate:De(d,C,{apiHolder:E})}]:[]))}catch(_){c(_.message)}},250,[l,a,E]),f?e.createElement("div",{className:p.containerWrapper},e.createElement("div",{className:p.container},e.createElement(Tt,{invalidator:f,setErrorText:c},e.createElement(Oe,{steps:f,fields:O,formData:s,onChange:_=>r(_.formData),onReset:()=>r({}),finishButtonLabel:i&&"Try It",onFinish:i&&(()=>i(s)),layouts:o})))):null}function At(t){const{setErrorText:a,fieldExtensions:l=[],layouts:s}=t,r=(0,B.u)(),i=(0,B.a)(),{selectedFile:c}=i,[m,o]=(0,e.useState)({}),p=async()=>{if(c)try{await r.execute({templateContent:c.content,values:m,files:i.files}),a()}catch(f){throw a(String(f.cause||f)),f}},E=c&&c.path.match(/\.ya?ml$/)?c.content:void 0;return e.createElement(Y,{onDryRun:p,fieldExtensions:l,setErrorText:a,content:E,data:m,onUpdate:o,layouts:s})}Y.DirectoryEditorDryRun=At;const Rt=(0,N.c)({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 3fr 2fr",gridTemplateRows:"1fr auto"},browser:{gridArea:"browser",overflow:"auto"},editor:{gridArea:"editor",overflow:"auto"},preview:{gridArea:"preview",overflow:"auto"},results:{gridArea:"results"}}),It=t=>{const a=Rt(),[l,s]=(0,e.useState)();return e.createElement(B.D,{directory:t.directory},e.createElement(B.b,null,e.createElement("main",{className:a.root},e.createElement("section",{className:a.browser},e.createElement(B.T,{onClose:t.onClose})),e.createElement("section",{className:a.editor},e.createElement(B.c.DirectoryEditor,{errorText:l})),e.createElement("section",{className:a.preview},e.createElement(Y.DirectoryEditorDryRun,{setErrorText:s,fieldExtensions:t.fieldExtensions,layouts:t.layouts})),e.createElement("section",{className:a.results},e.createElement(B.d,null)))))},Lt=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,Bt=(0,N.c)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},textArea:{gridArea:"textArea"},preview:{gridArea:"preview"}})),Ut=({defaultPreviewTemplate:t=Lt,customFieldExtensions:a=[],onClose:l,layouts:s=[]})=>{const r=Bt(),i=(0,I.u)(I.l),c=(0,I.u)(L.sf),[m,o]=(0,e.useState)(""),[p,E]=(0,e.useState)(),[f,u]=(0,e.useState)([]),[O,_]=(0,e.useState)(t),[v,P]=(0,e.useState)({}),{loading:C}=(0,ue.default)(()=>c.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:g})=>u(g.map(S=>{var U;return{label:(U=S.metadata.title)!=null?U:(0,L.g$)(S,{defaultKind:"template"}),value:S}}))).catch(g=>i.post({message:`Error loading exisiting templates: ${g.message}`,severity:"error"})),[c]),d=(0,e.useCallback)(g=>{o(g),_(ae.cp.stringify(g.spec))},[_]);return e.createElement(e.Fragment,null,C&&e.createElement(le.c,null),e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.c,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.c,{id:"select-template-label"},"Load Existing Template"),e.createElement(ie.c,{value:m,label:"Load Existing Template",labelId:"select-template-label",onChange:g=>d(g.target.value)},f.map((g,S)=>e.createElement(X.c,{key:S,value:g.value},g.label)))),e.createElement(j.c,{size:"medium",onClick:l},e.createElement(ge.c,null))),e.createElement("div",{className:r.textArea},e.createElement(B.c,{content:O,onUpdate:_,errorText:p})),e.createElement("div",{className:r.preview},e.createElement(Y,{data:v,onUpdate:P,content:O,contentIsSpec:!0,fieldExtensions:a,setErrorText:E,layouts:s}))))},Kt=(0,N.c)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview"}})),St=({customFieldExtensions:t=[],onClose:a})=>{var l,s;const r=Kt(),i=t.filter(d=>!!d.schema),[c,m]=(0,e.useState)(i[0]),[o,p]=(0,e.useState)({}),[E,f]=(0,e.useState)(Date.now()),[u,O]=(0,e.useState)({}),_=(0,e.useMemo)(()=>{var d,g;return ae.cp.stringify({parameters:[{title:`${c.name} Example`,properties:{[c.name]:{type:(g=(d=c.schema)==null?void 0:d.returnValue)==null?void 0:g.type,"ui:field":c.name,"ui:options":o}}}]})},[o,c]),v=(0,e.useMemo)(()=>Object.fromEntries(t.map(({name:d,component:g})=>[d,g])),[t]),P=(0,e.useCallback)(d=>{m(d),p({}),O({})},[p,m,O]),C=(0,e.useCallback)(d=>{p(d),f(Date.now())},[p,f]);return e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.c,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.c,{id:"select-field-label"},"Choose Custom Field Extension"),e.createElement(ie.c,{value:c,label:"Choose Custom Field Extension",labelId:"select-field-label",onChange:d=>P(d.target.value)},i.map((d,g)=>e.createElement(X.c,{key:g,value:d},d.name)))),e.createElement(j.c,{size:"medium",onClick:a,"aria-label":"Close"},e.createElement(ge.c,null))),e.createElement("div",{className:r.fieldForm},e.createElement(Z.c,null,e.createElement(ce.c,{title:"Field Options"}),e.createElement(q.c,null,e.createElement(fe.QF,{showErrorList:!1,fields:{...v},noHtml5Validate:!0,formData:o,formContext:{fieldFormState:o},onSubmit:d=>C(d.formData),validator:pe.cp,schema:((l=c.schema)==null?void 0:l.uiOptions)||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"}},e.createElement($.c,{variant:"contained",color:"primary",type:"submit",disabled:!((s=c.schema)!=null&&s.uiOptions)},"Apply"))))),e.createElement("div",{className:r.preview},e.createElement(Z.c,null,e.createElement(ce.c,{title:"Example Template Spec"}),e.createElement(q.c,null,e.createElement(Ge.cp,{readOnly:!0,theme:"dark",height:"100%",extensions:[Je.i_.define(Qe.o)],value:_}))),e.createElement(Y,{data:u,onUpdate:O,key:E,content:_,contentIsSpec:!0,fieldExtensions:t,setErrorText:()=>null})))};function Wt(t){const[a,l]=(0,e.useState)();let s=null;return(a==null?void 0:a.type)==="local"?s=e.createElement(It,{directory:a.directory,fieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="form"?s=e.createElement(Ut,{defaultPreviewTemplate:t.defaultPreviewTemplate,customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="field-explorer"?s=e.createElement(St,{customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0)}):s=e.createElement(h.kP,null,e.createElement(B.e,{onSelect:r=>{r==="local"?B.W.requestDirectoryAccess().then(i=>l({type:"local",directory:i})).catch(()=>{}):r==="form"?l({type:"form"}):r==="field-explorer"&&l({type:"field-explorer"})}})),e.createElement(h.K2,{themeId:"home"},e.createElement(h.ek,{title:"Template Editor",subtitle:"Edit, preview, and try out templates and template forms"}),s)}const bt=t=>{const{groups:a,templateFilter:l,components:s={},defaultPreviewTemplate:r}=t,{ReviewStepComponent:i,TemplateCardComponent:c,TaskPageComponent:m}=s,o=(0,M.ag)(),p=m!=null?m:B.g,E=(0,_e.m_)(o),f=[...E,...B.f.filter(({name:_})=>!E.some(v=>v.name===_))],u=(0,_e.qA)(o),O=()=>{const{templateName:_}=(0,R.oD)(y.x),v=(0,R.M7)(y.o);return(0,e.useEffect)(()=>console.warn("The route /template/:templateName is deprecated, please use the new /template/:namespace/:templateName route instead"),[]),e.createElement(M.YX,{to:v({namespace:"default",templateName:_})})};return e.createElement(M.c5,null,e.createElement(M.kX,{path:"/",element:e.createElement(Et,{groups:a,templateFilter:l,TemplateCardComponent:c,contextMenu:t.contextMenu,headerOptions:t.headerOptions})}),e.createElement(M.kX,{path:y.x.path,element:e.createElement(O,null)}),e.createElement(M.kX,{path:y.o.path,element:e.createElement(V.S,null,e.createElement(Dt,{ReviewStepComponent:i,customFieldExtensions:f,layouts:u,headerOptions:t.headerOptions}))}),e.createElement(M.kX,{path:y.t.path,element:e.createElement(B.L,null)}),e.createElement(M.kX,{path:y.w.path,element:e.createElement(p,null)}),e.createElement(M.kX,{path:y.q.path,element:e.createElement(B.A,null)}),e.createElement(M.kX,{path:y.p.path,element:e.createElement(V.S,null,e.createElement(Wt,{defaultPreviewTemplate:r,customFieldExtensions:f,layouts:u}))}),e.createElement(M.kX,{path:"preview",element:e.createElement(M.YX,{to:"../edit"})}))}}}]);})();

//# sourceMappingURL=7616.a387b9f8.chunk.js.map