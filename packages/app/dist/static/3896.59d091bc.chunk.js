"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3896],{3896:(ne,T,n)=>{n.r(T),n.d(T,{CatalogGraphPage:()=>Be});var C=n(17376),h=n(8024),A=n(29292),S=n(91812),P=n(38348),p=n(8640),L=n(40476),le=n(53232),x=n(94700),re=n(35676),oe=n(83952),se=n(67256),k=n(63524),V=n(66424),Y=n(93852),ce=n(21048),z=n(19947),ie=n(22776),ue=n(74048),me=n(8148),$=n(88724),Ee=n(62076),e=n(85668),j=n(33648),v=n(4788),_e=n(85324),Q=n(61571),X=n(79736),w=n(7312),de=n(35848),ge=n(55632),Z=n.n(ge),J=n(29260),he=n(71252),We=n.n(he),pe=n(43184),Ne=n.n(pe);const ve={curveMonotoneX:"Monotone X",curveStepBefore:"Step Before"},Me=["curveMonotoneX","curveStepBefore"],Ce=({value:a,onChange:r})=>{const t=(0,e.useCallback)(o=>r(o),[r]);return e.createElement(p.c,{pb:1,pt:1},e.createElement(h.M1,{label:"Curve",selected:a,items:Me.map(o=>({label:ve[o],value:o})),onChange:t}))},Pe={[v.wN.LEFT_RIGHT]:"Left to right",[v.wN.RIGHT_LEFT]:"Right to left",[v.wN.TOP_BOTTOM]:"Top to bottom",[v.wN.BOTTOM_TOP]:"Bottom to top"},Oe=({value:a,onChange:r})=>{const t=(0,e.useCallback)(o=>r(o),[r]);return e.createElement(p.c,{pb:1,pt:1},e.createElement(h.M1,{label:"Direction",selected:a,items:Object.values(v.wN).map(o=>({label:Pe[o],value:o})),onChange:t}))},De=(0,L.c)({formControl:{width:"100%",maxWidth:300}},{name:"PluginCatalogGraphMaxDepthFilter"}),fe=({value:a,onChange:r})=>{const t=De(),o=(0,e.useRef)(r),[c,u]=(0,e.useState)(a);(0,e.useEffect)(()=>{o.current=r},[r]),(0,e.useEffect)(()=>{u(a)},[a]);const m=(0,e.useCallback)(E=>{const d=Number(E.target.value),s=Number.isFinite(d)&&d>0?d:Number.POSITIVE_INFINITY;u(s),o.current(s)},[]),i=(0,e.useCallback)(()=>{u(Number.POSITIVE_INFINITY),o.current(Number.POSITIVE_INFINITY)},[o]);return e.createElement(p.c,{pb:1,pt:1},e.createElement(le.c,{variant:"outlined",className:t.formControl},e.createElement(x.c,{variant:"button"},"Max Depth"),e.createElement(re.c,{type:"number",placeholder:"\u221E Infinite",value:Number.isFinite(c)?String(c):"",onChange:m,endAdornment:e.createElement(oe.c,{position:"end"},e.createElement(se.c,{"aria-label":"clear max depth",onClick:i,edge:"end"},e.createElement(_e.c,null))),inputProps:{"aria-label":"maxp"},labelWidth:0})))},Re=(0,L.c)({formControl:{maxWidth:300}},{name:"PluginCatalogGraphSelectedKindsFilter"}),Ie=({value:a,onChange:r})=>{const t=Re(),o=(0,A.u)(A.l),c=(0,A.u)(P.sf),{error:u,value:m}=(0,de.default)(async()=>await c.getEntityFacets({facets:["kind"]}).then(s=>{var _;return((_=s.facets.kind)==null?void 0:_.map(g=>g.value).sort())||[]}));(0,e.useEffect)(()=>{u&&o.post({message:"Failed to load entity kinds",severity:"error"})},[u,o]);const i=(0,e.useMemo)(()=>m&&m.map(s=>s.toLocaleLowerCase("en-US")),[m]),E=(0,e.useCallback)((s,_)=>{r(i&&i.every(g=>_.includes(g))?void 0:_)},[i,r]),d=(0,e.useCallback)(()=>{r(a!=null&&a.length?a:void 0)},[a,r]);return!(m!=null&&m.length)||!(i!=null&&i.length)||u?e.createElement(e.Fragment,null):e.createElement(p.c,{pb:1,pt:1},e.createElement(x.c,{variant:"button"},"Kinds"),e.createElement($.cp,{className:t.formControl,multiple:!0,limitTags:4,disableCloseOnSelect:!0,"aria-label":"Kinds",options:i,value:a!=null?a:i,getOptionLabel:s=>{var _;return(_=m[i.indexOf(s)])!=null?_:s},onChange:E,onBlur:d,renderOption:(s,{selected:_})=>{var g;return e.createElement(k.c,{control:e.createElement(V.c,{icon:e.createElement(X.c,{fontSize:"small"}),checkedIcon:e.createElement(Q.c,{fontSize:"small"}),checked:_}),label:(g=m[i.indexOf(s)])!=null?g:s})},size:"small",popupIcon:e.createElement(w.c,{"data-testid":"selected-kinds-expand"}),renderInput:s=>e.createElement(Y.c,{...s,variant:"outlined"})}))},ye=(0,L.c)({formControl:{maxWidth:300}},{name:"PluginCatalogGraphSelectedRelationsFilter"}),Te=({relationPairs:a,value:r,onChange:t})=>{const o=ye(),c=(0,e.useMemo)(()=>a.flat(),[a]),u=(0,e.useCallback)((i,E)=>{t(c.every(d=>E.includes(d))?void 0:E)},[c,t]),m=(0,e.useCallback)(()=>{t(r!=null&&r.length?r:void 0)},[r,t]);return e.createElement(p.c,{pb:1,pt:1},e.createElement(x.c,{variant:"button"},"Relations"),e.createElement($.cp,{className:o.formControl,multiple:!0,limitTags:4,disableCloseOnSelect:!0,"aria-label":"Relations",options:c,value:r!=null?r:c,onChange:u,onBlur:m,renderOption:(i,{selected:E})=>e.createElement(k.c,{control:e.createElement(V.c,{icon:e.createElement(X.c,{fontSize:"small"}),checkedIcon:e.createElement(Q.c,{fontSize:"small"}),checked:E}),label:i}),size:"small",popupIcon:e.createElement(w.c,{"data-testid":"selected-relations-expand"}),renderInput:i=>e.createElement(Y.c,{...i,variant:"outlined"})}))},Ae=(0,L.c)({root:{width:"100%",maxWidth:300}},{name:"PluginCatalogGraphSwitchFilter"}),q=({label:a,value:r,onChange:t})=>{const o=Ae(),c=(0,e.useCallback)(u=>{t(u.target.checked)},[t]);return e.createElement(p.c,{pb:1,pt:1},e.createElement(k.c,{control:e.createElement(ce.c,{checked:r,onChange:c,name:a,color:"primary"}),label:a,className:o.root}))};function Le({initialState:a={}}){const r=(0,j.IT)(),t=(0,e.useMemo)(()=>Z().parse(r.search,{arrayLimit:0,ignoreQueryPrefix:!0})||{},[r.search]),[o,c]=(0,e.useState)(()=>{var l;return(Array.isArray(t.rootEntityRefs)?t.rootEntityRefs:(l=a==null?void 0:a.rootEntityRefs)!=null?l:[]).map(D=>(0,C.WK)(D))}),[u,m]=(0,e.useState)(()=>{var l;return typeof t.maxDepth=="string"?ee(t.maxDepth):(l=a==null?void 0:a.maxDepth)!=null?l:Number.POSITIVE_INFINITY}),[i,E]=(0,e.useState)(()=>Array.isArray(t.selectedRelations)?t.selectedRelations:a==null?void 0:a.selectedRelations),[d,s]=(0,e.useState)(()=>{var l;return(l=Array.isArray(t.selectedKinds)?t.selectedKinds:a==null?void 0:a.selectedKinds)==null?void 0:l.map(D=>D.toLocaleLowerCase("en-US"))}),[_,g]=(0,e.useState)(()=>{var l;return typeof t.unidirectional=="string"?t.unidirectional==="true":(l=a==null?void 0:a.unidirectional)!=null?l:!0}),[K,f]=(0,e.useState)(()=>{var l;return typeof t.mergeRelations=="string"?t.mergeRelations==="true":(l=a==null?void 0:a.mergeRelations)!=null?l:!0}),[B,R]=(0,e.useState)(()=>{var l;return typeof t.direction=="string"?t.direction:(l=a==null?void 0:a.direction)!=null?l:v.wN.LEFT_RIGHT}),[H,F]=(0,e.useState)(()=>{var l;return typeof t.curve=="string"?t.curve:(l=a==null?void 0:a.curve)!=null?l:"curveMonotoneX"}),[W,O]=(0,e.useState)(()=>{var l;return typeof t.showFilters=="string"?t.showFilters==="true":(l=a==null?void 0:a.showFilters)!=null?l:!0}),b=(0,e.useCallback)(()=>O(l=>!l),[O]),N=(0,J.c)(r.search);(0,e.useEffect)(()=>{r.search!==N&&(Array.isArray(t.rootEntityRefs)&&c(t.rootEntityRefs.map(l=>(0,C.WK)(l))),typeof t.maxDepth=="string"&&m(ee(t.maxDepth)),Array.isArray(t.selectedKinds)&&s(t.selectedKinds),Array.isArray(t.selectedRelations)&&E(t.selectedRelations),typeof t.unidirectional=="string"&&g(t.unidirectional==="true"),typeof t.mergeRelations=="string"&&f(t.mergeRelations==="true"),typeof t.direction=="string"&&R(t.direction),typeof t.showFilters=="string"&&O(t.showFilters==="true"))},[N,r.search,t,c,m,s,E,g,f,R,O]);const I=(0,J.c)(o.map(l=>(0,C.Qj)(l)));return(0,e.useEffect)(()=>{const l=o.map(U=>(0,C.Qj)(U)),D=Z().stringify({rootEntityRefs:l,maxDepth:isFinite(u)?u:"\u221E",selectedKinds:d,selectedRelations:i,unidirectional:_,mergeRelations:K,direction:B,showFilters:W},{arrayFormat:"brackets",addQueryPrefix:!0}),M=`${window.location.pathname}${D}`;!I||l.length===I.length&&l.every((U,G)=>U===I[G])?window.history.replaceState(null,document.title,M):window.history.pushState(null,document.title,M)},[o,u,d,i,_,K,B,W,I]),{rootEntityNames:o,setRootEntityNames:c,maxDepth:u,setMaxDepth:m,selectedRelations:i,setSelectedRelations:E,selectedKinds:d,setSelectedKinds:s,unidirectional:_,setUnidirectional:g,mergeRelations:K,setMergeRelations:f,direction:B,setDirection:R,curve:H,setCurve:F,showFilters:W,toggleShowFilters:b}}function ee(a){return a==="\u221E"?Number.POSITIVE_INFINITY:Number(a)}const Ke=(0,L.c)(a=>({content:{minHeight:0},container:{height:"100%",maxHeight:"100%",minHeight:0},fullHeight:{maxHeight:"100%",display:"flex",minHeight:0},graphWrapper:{position:"relative",flex:1,minHeight:0,display:"flex"},graph:{flex:1,minHeight:0},legend:{position:"absolute",bottom:0,right:0,padding:a.spacing(1),"& .icon":{verticalAlign:"bottom"}},filters:{display:"grid",gridGap:a.spacing(1),gridAutoRows:"auto",[a.breakpoints.up("lg")]:{display:"block"},[a.breakpoints.only("md")]:{gridTemplateColumns:"repeat(3, 1fr)"},[a.breakpoints.only("sm")]:{gridTemplateColumns:"repeat(2, 1fr)"},[a.breakpoints.down("xs")]:{gridTemplateColumns:"repeat(1, 1fr)"}}}),{name:"PluginCatalogGraphCatalogGraphPage"}),Be=a=>{const{relationPairs:r=v.oV,initialState:t}=a,o=(0,j.i6)(),c=Ke(),u=(0,S.M7)(P.I6),{maxDepth:m,setMaxDepth:i,selectedKinds:E,setSelectedKinds:d,selectedRelations:s,setSelectedRelations:_,unidirectional:g,setUnidirectional:K,mergeRelations:f,setMergeRelations:B,direction:R,setDirection:H,curve:F,setCurve:W,rootEntityNames:O,setRootEntityNames:b,showFilters:N,toggleShowFilters:I}=Le({initialState:t}),l=(0,S.S2)(),D=(0,e.useCallback)((M,U)=>{var G,te;const y=(0,C.WK)(M.id);if(U.shiftKey){const ae=u({kind:y.kind.toLocaleLowerCase("en-US"),namespace:y.namespace.toLocaleLowerCase("en-US"),name:y.name});l.captureEvent("click",(G=M.entity.metadata.title)!=null?G:(0,P.g$)(y),{attributes:{to:ae}}),o(ae)}else l.captureEvent("click",(te=M.entity.metadata.title)!=null?te:(0,P.g$)(y)),b([y])},[u,o,b,l]);return e.createElement(h.K2,{themeId:"home"},e.createElement(h.ek,{title:"Catalog Graph",subtitle:O.map(M=>(0,P.g$)(M)).join(", ")}),e.createElement(h.kP,{stretch:!0,className:c.content},e.createElement(h.YC,{titleComponent:e.createElement(Ee.c,{value:"show filters",selected:N,onChange:()=>I()},e.createElement(ue.c,null)," Filters")},e.createElement(h.iY,null,"Start tracking your component in by adding it to the software catalog.")),e.createElement(z.c,{container:!0,alignItems:"stretch",className:c.container},N&&e.createElement(z.c,{item:!0,xs:12,lg:2,className:c.filters},e.createElement(fe,{value:m,onChange:i}),e.createElement(Ie,{value:E,onChange:d}),e.createElement(Te,{value:s,onChange:_,relationPairs:r}),e.createElement(Oe,{value:R,onChange:H}),e.createElement(Ce,{value:F,onChange:W}),e.createElement(q,{value:g,onChange:K,label:"Simplified"}),e.createElement(q,{value:f,onChange:B,label:"Merge Relations"})),e.createElement(z.c,{item:!0,xs:!0,className:c.fullHeight},e.createElement(ie.c,{className:c.graphWrapper},e.createElement(x.c,{variant:"caption",color:"textSecondary",display:"block",className:c.legend},e.createElement(me.c,{className:"icon"})," Use pinch & zoom to move around the diagram. Click to change active node, shift click to navigate to entity."),e.createElement(v.eo,{...a,rootEntityNames:O,maxDepth:m,kinds:E&&E.length>0?E:void 0,relations:s&&s.length>0?s:void 0,mergeRelations:f,unidirectional:g,onNodeClick:D,direction:R,relationPairs:r,className:c.graph,zoom:"enabled",curve:F}))))))}},8148:(ne,T,n)=>{var C,h=n(96848),A=n(86456);C={value:!0},T.c=void 0;var S=A(n(85668)),P=h(n(2976)),p=(0,P.default)(S.createElement("path",{d:"M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3h-6zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3v6zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6h6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6v-6z"}),"ZoomOutMap");T.c=p}}]);})();

//# sourceMappingURL=3896.59d091bc.chunk.js.map